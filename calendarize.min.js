class Calendarizer extends HTMLElement{constructor(){super(),this.__opened=null,this.__button=null,this.google=null,this.outlook=null,this.yahoo=null}static get observedAttributes(){return["button","title","date-start","timezone","location","organizer","content"]}get button(){return this.getAttribute("button")}get title(){return this.getAttribute("title")}get dateStart(){return this.getAttribute("date-start")}get dateEnd(){return this.getAttribute("date-end")}get timezone(){return this.getAttribute("timezone")}get location(){return this.getAttribute("location")}get organizer(){return this.getAttribute("organizer")}get content(){return this.getAttribute("content")}set button(t){return this.setAttribute("button",t)}set title(t){return this.setAttribute("title",t)}set dateStart(t){return this.setAttribute("date-start",t)}set dateEnd(t){return this.setAttribute("date-end",t)}set timezone(t){return this.setAttribute("timezone",t)}set location(t){return this.setAttribute("location",t)}set organizer(t){return this.setAttribute("organizer",t)}set content(t){return this.setAttribute("content",t)}parseDate=t=>{const e=new Date(Date.parse(t));return{d:String(e.getDate()).padStart(2,"0"),m:String(e.getMonth()+1).padStart(2,"0"),y:e.getFullYear(),h:String(e.getHours()).padStart(2,"0"),n:String(e.getMinutes()).padStart(2,"0")}};googleDateFormat=t=>{const e=this.parseDate(t);return`${e.y}${e.m}${e.d}T${e.h}${e.n}:00`};outlookDateFormat=t=>{const e=this.parseDate(t);return`${e.y}-${e.m}-${e.d}T${e.h}:${e.n}:00`};lbr=t=>(t=(t=t.replace(/<br>/g,"%0A%0A")).replace(/<br\/>/g,"%0A%0A"),encodeURIComponent(t));genGoogleLink=()=>`https://calendar.google.com/calendar/u/0/r/eventedit?text=${encodeURI(this.title)}&dates=${this.googleDateFormat(this.dateStart)}/${this.googleDateFormat(this.dateEnd)}&ctz=${this.timezone}&details=${encodeURI(this.content)}&location=${encodeURI(this.location)}&pli=1`;genOutlookLink=()=>`https://outlook.live.com/calendar/0/deeplink/compose?rru=addevent&path=%2Fcalendar%2Faction%2Fcompose&startdt=${this.outlookDateFormat(this.dateStart)}&enddt=${this.outlookDateFormat(this.dateEnd)}&subject=${encodeURI(this.title)}&body=${encodeURI(this.content)}&location=${encodeURI(this.location)}&allday=false`;genYahooLink=()=>`https://calendar.yahoo.com/?v=60&title=${encodeURI(this.title)}&desc=${this.lbr(this.content)}&in_loc=${encodeURI(this.location)}&st=${this.googleDateFormat(this.dateStart)}&et=${this.googleDateFormat(this.dateEnd)}`;connectedCallback(){this.attachShadow({mode:"open"});var t=document.createElement("div");t.setAttribute("class","container"),t.style="display: inline-block",this.__button=document.createElement("button"),this.__button.innerHTML=`${this.button} <span class="btn-arrow"></span>`,this.__button.setAttribute("class","btn-cal-dropdown");var e=document.createElement("ul");e.setAttribute("class","dropdown-cal-menu"),this.google=document.createElement("li"),this.google.innerHTML=`<a href="${this.genGoogleLink()}" target="_blank"><li>Google Calendar</li></a>`,this.outlook=document.createElement("li"),this.outlook.innerHTML=`<a href="${this.genOutlookLink()}" target="_blank"><li>Outlook Calendar</li></a>`,this.yahoo=document.createElement("li"),this.yahoo.innerHTML=`<a href="${this.genYahooLink()}" target="_blank"><li>Yahoo Calendar</li></a>`;const n=document.createElement("style");n.textContent="\n    .btn-buy:hover {\n      background: #6e6cfb;\n    }\n    .btn-cal-dropdown {\n      font-family: Poppins, Helvetica, sans-serif;\n      border: 1px solid #6e6cfb;\n      border-radius: 5px;\n      font-size: 12px;\n      font-weight: bold;\n      padding: 10px 15px;\n      background: #fff;\n      margin: 2px;\n      position: relative;\n    }\n    .btn-cal-dropdown:hover {\n      background: #6e6cfb;\n      color: #fff\n    }\n    .btn-cal-dropdown:hover .btn-arrow,\n    .btn-cal-dropdown:focus .btn-arrow {\n      border-top: 5px solid #fff;\n    }\n    .btn-cal-dropdown:active,\n    .btn-cal-dropdown:focus {\n      outline: none;\n      background: #6e6cfb;\n      color: #fff;\n    }\n    .btn-arrow {\n      width: 0;\n      height: 0;\n      border-top: 5px solid #000;\n      border-right: 5px solid transparent;\n      border-bottom: 5px solid transparent;\n      border-left: 5px solid transparent;\n      position: relative;\n      top: 10px;\n      margin-left: 15px;\n    }\n    .dropdown-cal-menu {\n      position: absolute;\n      z-index: 1000;\n      display: none;\n      min-width: 160px;\n      padding: 5px 0;\n      margin: -1px 0 0 0;\n      list-style: none;\n      background-color: #fff;\n      border: 1px solid #ccc;\n      border-radius: 3px;\n      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);\n      background-clip: padding-box;\n    }\n    .dropdown-cal-menu a {\n      text-decoration: none;\n    }\n    .dropdown-cal-menu a li {\n      font-size: 12px;\n      font-family: arial,sans-serif;\n      color: #222;\n      padding: 5px 15px;\n    }\n    .dropdown-cal-menu a li:hover {\n      background-color: #bae2fc;\n    }\n    .show {\n      display: block;\n    }\n    ",this.shadowRoot.appendChild(n),this.shadowRoot.appendChild(t),t.appendChild(this.__button),t.appendChild(e),e.appendChild(this.google),e.appendChild(this.outlook),e.appendChild(this.yahoo);const toggleVisibility=t=>{t.classList.toggle("show")},handleDropdown=t=>{const e=t.parentElement.lastChild;toggleVisibility(e),this.__opened?this.__opened==e?this.__opened=null:(toggleVisibility(this.__opened),this.__opened=e):this.__opened=e};document.addEventListener("click",(t=>{this.__button==t.path[0]?handleDropdown(this.__button):this.__opened&&(toggleVisibility(this.__opened),this.__opened=null)}))}attributeChangedCallback(t,e,n){if(e)if("button"===t)this.__button.innerHTML=`${n} <span class="btn-arrow"></span>`;else this.google.innerHTML=`<a href="${this.genGoogleLink()}" target="_blank"><li>Google Calendar</li></a>`,this.outlook.innerHTML=`<a href="${this.genOutlookLink()}" target="_blank"><li>Outlook Calendar</li></a>`,this.yahoo.innerHTML=`<a href="${this.genYahooLink()}" target="_blank"><li>Yahoo Calendar</li></a>`}}function init(){customElements.define("calendarizer-io",Calendarizer);const t=document.createElement("link");t.href="https://fonts.googleapis.com/css?family=Poppins&display=swap",t.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(t)}window.attachEvent?window.attachEvent("onload",init):window.addEventListener?window.addEventListener("load",init,!1):document.addEventListener("load",init,!1);