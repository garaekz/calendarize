class Calendarizer extends HTMLElement{constructor(){super(),this.__opened=null,this.__button=null,this.google=null,this.outlook=null,this.yahoo=null}static get observedAttributes(){return["button","title","date-start","timezone","location","organizer","content"]}get button(){return this.getAttribute("button")}get title(){return this.getAttribute("title")}get dateStart(){return this.getAttribute("date-start")}get dateEnd(){return this.getAttribute("date-end")}get timezone(){return this.getAttribute("timezone")}get location(){return this.getAttribute("location")}get organizer(){return this.getAttribute("organizer")}get content(){return this.getAttribute("content")}set button(newData){return this.setAttribute("button",newData)}set title(newData){return this.setAttribute("title",newData)}set dateStart(newData){return this.setAttribute("date-start",newData)}set dateEnd(newData){return this.setAttribute("date-end",newData)}set timezone(newData){return this.setAttribute("timezone",newData)}set location(newData){return this.setAttribute("location",newData)}set organizer(newData){return this.setAttribute("organizer",newData)}set content(newData){return this.setAttribute("content",newData)}parseDate=dt=>{const d=new Date(Date.parse(dt));return{d:String(d.getDate()).padStart(2,"0"),m:String(d.getMonth()+1).padStart(2,"0"),y:d.getFullYear(),h:String(d.getHours()).padStart(2,"0"),n:String(d.getMinutes()).padStart(2,"0")}};googleDateFormat=dt=>{const d=this.parseDate(dt);return`${d.y}${d.m}${d.d}T${d.h}${d.n}:00`};outlookDateFormat=dt=>{const d=this.parseDate(dt);return`${d.y}-${d.m}-${d.d}T${d.h}:${d.n}:00`};lbr=str=>(str=(str=str.replace(/<br>/g,"%0A%0A")).replace(/<br\/>/g,"%0A%0A"),encodeURIComponent(str));genGoogleLink=()=>`https://calendar.google.com/calendar/u/0/r/eventedit?text=${encodeURI(this.title)}&dates=${this.googleDateFormat(this.dateStart)}/${this.googleDateFormat(this.dateEnd)}&ctz=${this.timezone}&details=${encodeURI(this.content)}&location=${encodeURI(this.location)}&pli=1`;genOutlookLink=()=>`https://outlook.live.com/calendar/0/deeplink/compose?rru=addevent&path=%2Fcalendar%2Faction%2Fcompose&startdt=${this.outlookDateFormat(this.dateStart)}&enddt=${this.outlookDateFormat(this.dateEnd)}&subject=${encodeURI(this.title)}&body=${encodeURI(this.content)}&location=${encodeURI(this.location)}&allday=false`;genYahooLink=()=>`https://calendar.yahoo.com/?v=60&title=${encodeURI(this.title)}&desc=${this.lbr(this.content)}&in_loc=${encodeURI(this.location)}&st=${this.googleDateFormat(this.dateStart)}&et=${this.googleDateFormat(this.dateEnd)}`;connectedCallback(){this.attachShadow({mode:"open"});var container=document.createElement("div");container.setAttribute("class","container"),container.style="display: inline-block",this.__button=document.createElement("button"),this.__button.innerHTML=`${this.button} <span class="btn-arrow"></span>`,this.__button.setAttribute("class","btn-cal-dropdown");var detailContainer=document.createElement("ul");detailContainer.setAttribute("class","dropdown-cal-menu"),this.google=document.createElement("li"),this.google.innerHTML=`<a href="${this.genGoogleLink()}" target="_blank"><li>Google Calendar</li></a>`,this.outlook=document.createElement("li"),this.outlook.innerHTML=`<a href="${this.genOutlookLink()}" target="_blank"><li>Outlook Calendar</li></a>`,this.yahoo=document.createElement("li"),this.yahoo.innerHTML=`<a href="${this.genYahooLink()}" target="_blank"><li>Yahoo Calendar</li></a>`;const style=document.createElement("style");style.textContent="\n    .btn-buy:hover {\n      background: #6e6cfb;\n    }\n    .btn-cal-dropdown {\n      font-family: Poppins, Helvetica, sans-serif;\n      border: 1px solid #6e6cfb;\n      border-radius: 5px;\n      font-size: 12px;\n      font-weight: bold;\n      padding: 10px 15px;\n      background: #fff;\n      margin: 2px;\n      position: relative;\n    }\n    .btn-cal-dropdown:hover {\n      background: #6e6cfb;\n      color: #fff\n    }\n    .btn-cal-dropdown:hover .btn-arrow,\n    .btn-cal-dropdown:focus .btn-arrow {\n      border-top: 5px solid #fff;\n    }\n    .btn-cal-dropdown:active,\n    .btn-cal-dropdown:focus {\n      outline: none;\n      background: #6e6cfb;\n      color: #fff;\n    }\n    .btn-arrow {\n      width: 0;\n      height: 0;\n      border-top: 5px solid #000;\n      border-right: 5px solid transparent;\n      border-bottom: 5px solid transparent;\n      border-left: 5px solid transparent;\n      position: relative;\n      top: 10px;\n      margin-left: 15px;\n    }\n    .dropdown-cal-menu {\n      position: absolute;\n      z-index: 1000;\n      display: none;\n      min-width: 160px;\n      padding: 5px 0;\n      margin: -1px 0 0 0;\n      list-style: none;\n      background-color: #fff;\n      border: 1px solid #ccc;\n      border-radius: 3px;\n      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);\n      background-clip: padding-box;\n    }\n    .dropdown-cal-menu a {\n      text-decoration: none;\n    }\n    .dropdown-cal-menu a li {\n      font-size: 12px;\n      font-family: arial,sans-serif;\n      color: #222;\n      padding: 5px 15px;\n    }\n    .dropdown-cal-menu a li:hover {\n      background-color: #bae2fc;\n    }\n    .show {\n      display: block;\n    }\n    ",this.shadowRoot.appendChild(style),this.shadowRoot.appendChild(container),container.appendChild(this.__button),container.appendChild(detailContainer),detailContainer.appendChild(this.google),detailContainer.appendChild(this.outlook),detailContainer.appendChild(this.yahoo);const toggleVisibility=e=>{e.classList.toggle("show")},handleDropdown=e=>{const clickedItem=e.parentElement.lastChild;toggleVisibility(clickedItem),this.__opened?this.__opened==clickedItem?this.__opened=null:(toggleVisibility(this.__opened),this.__opened=clickedItem):this.__opened=clickedItem};document.addEventListener("click",(event=>{const isButtonClicked=event.composedPath().includes(this.__button),isDropdownOpen=null!=this.__opened;isButtonClicked?handleDropdown(this.__button):isDropdownOpen&&(toggleVisibility(this.__opened),this.__opened=null)}))}attributeChangedCallback(attr,oldVal,newVal){if(oldVal)if("button"===attr)this.__button.innerHTML=`${newVal} <span class="btn-arrow"></span>`;else this.google.innerHTML=`<a href="${this.genGoogleLink()}" target="_blank"><li>Google Calendar</li></a>`,this.outlook.innerHTML=`<a href="${this.genOutlookLink()}" target="_blank"><li>Outlook Calendar</li></a>`,this.yahoo.innerHTML=`<a href="${this.genYahooLink()}" target="_blank"><li>Yahoo Calendar</li></a>`}}function init(){customElements.define("calendarizer-io",Calendarizer);const link=document.createElement("link");link.href="https://fonts.googleapis.com/css?family=Poppins&display=swap",link.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(link)}window.attachEvent?window.attachEvent("onload",init):window.addEventListener?window.addEventListener("load",init,!1):document.addEventListener("load",init,!1);